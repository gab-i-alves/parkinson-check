@if (isLoading()) {
<!-- Skeleton Loading State -->
<div class="min-h-screen bg-neutral-50 relative overflow-hidden">
  <div class="container mx-auto px-6 py-8 space-y-8">
    <!-- Header Skeleton -->
    <div class="animate-pulse">
      <div class="h-10 bg-neutral-200 rounded-xl w-64"></div>
    </div>

    <!-- KPIs Skeleton -->
    <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4">
      @for (i of [1,2,3,4]; track i) {
        <div class="bg-white rounded-2xl shadow-sm border border-neutral-200 p-6 animate-pulse">
          <div class="h-4 bg-neutral-200 rounded w-3/4 mb-4"></div>
          <div class="h-8 bg-neutral-200 rounded w-1/2"></div>
        </div>
      }
    </div>

    <!-- Pending Doctors Skeleton -->
    <div class="space-y-4">
      <div class="h-8 bg-neutral-200 rounded w-48 animate-pulse"></div>
      <div class="bg-white rounded-2xl shadow-sm border border-neutral-200 p-6 animate-pulse">
        <div class="h-4 bg-neutral-200 rounded w-3/4 mb-4"></div>
        <div class="h-64 bg-neutral-100 rounded-xl"></div>
      </div>
    </div>
  </div>
</div>
} @else {
<div class="min-h-screen bg-neutral-50 relative">
  <!-- Background decorativo -->
  <div class="absolute top-0 left-0 w-full h-full -z-10 overflow-hidden">
    <div class="absolute top-[-10%] right-[-5%] w-96 h-96 bg-pink-200/20 rounded-full filter blur-3xl"></div>
    <div class="absolute bottom-[-10%] left-[-5%] w-96 h-96 bg-blue-200/20 rounded-full filter blur-3xl"></div>
    <div class="absolute top-[30%] left-[10%] w-64 h-64 bg-yellow-200/20 rounded-full filter blur-3xl"></div>
  </div>

  <div class="container mx-auto px-6 py-8 space-y-8 relative">

    <!-- SEÇÃO 1: VISÃO GERAL DO SISTEMA -->
    <div class="space-y-5">
      <h2 class="text-xl font-bold text-neutral-900">Visão Geral do Sistema</h2>

      <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4">
        <!-- KPI 1: Total de Usuários - AZUL -->
        <div class="bg-blue-100 rounded-2xl shadow-sm border border-blue-200 p-5 hover:shadow-md hover:-translate-y-1 transition-all duration-200 relative overflow-hidden">
          <div class="absolute inset-0 opacity-20" style="background-image: radial-gradient(circle, rgb(26, 26, 26) 1px, transparent 1px); background-size: 16px 16px;"></div>
          <div class="relative z-10">
            <div class="flex items-center justify-center gap-2 mb-2">
              <p class="text-xs font-medium text-neutral-700">Total de Usuários</p>
              <button
                type="button"
                class="inline-flex items-center justify-center p-1 rounded hover:bg-blue-200/50 transition-colors"
                aria-label="Informações sobre total de usuários"
                [appTooltip]="'Soma de todos os usuários cadastrados no sistema (pacientes + médicos + administradores)'"
                [tooltipPosition]="'top'"
              >
                <svg class="w-3.5 h-3.5 text-neutral-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
              </button>
            </div>
            <div class="flex flex-col items-center text-center space-y-1">
              <p class="text-4xl font-bold text-neutral-900">{{ adminStats()?.total_users || 0 }}</p>
              <p class="text-sm text-neutral-600">usuários cadastrados</p>
            </div>
          </div>
        </div>

        <!-- KPI 2: Total de Pacientes - ROSA -->
        <div class="bg-pink-100 rounded-2xl shadow-sm border border-pink-200 p-5 hover:shadow-md hover:-translate-y-1 transition-all duration-200 relative overflow-hidden">
          <svg class="absolute bottom-0 right-0 w-24 h-24 opacity-20" viewBox="0 0 200 200">
            <path d="M0,100 Q50,50 100,100 T200,100 L200,200 L0,200 Z" fill="currentColor"/>
          </svg>
          <div class="relative z-10">
            <div class="flex items-center justify-center gap-2 mb-2">
              <p class="text-xs font-medium text-neutral-700">Total de Pacientes</p>
              <button
                type="button"
                class="inline-flex items-center justify-center p-1 rounded hover:bg-pink-200/50 transition-colors"
                aria-label="Informações sobre total de pacientes"
                [appTooltip]="'Quantidade total de pacientes cadastrados no sistema'"
                [tooltipPosition]="'top'"
              >
                <svg class="w-3.5 h-3.5 text-neutral-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
              </button>
            </div>
            <div class="flex flex-col items-center text-center space-y-1">
              <p class="text-4xl font-bold text-neutral-900">{{ adminStats()?.total_patients || 0 }}</p>
              <p class="text-sm text-neutral-600">pacientes no sistema</p>
            </div>
          </div>
        </div>

        <!-- KPI 3: Total de Médicos - VERDE -->
        <div class="bg-green-100 rounded-2xl shadow-sm border border-green-200 p-5 hover:shadow-md hover:-translate-y-1 transition-all duration-200 relative overflow-hidden">
          <div class="absolute top-2 right-2 w-16 h-16 opacity-20">
            <div class="w-8 h-8 bg-current rounded-full"></div>
            <div class="w-5 h-5 bg-current rounded-full absolute top-3 left-6"></div>
          </div>
          <div class="relative z-10">
            <div class="flex items-center justify-center gap-2 mb-2">
              <p class="text-xs font-medium text-neutral-700">Total de Médicos</p>
              <button
                type="button"
                class="inline-flex items-center justify-center p-1 rounded hover:bg-green-200/50 transition-colors"
                aria-label="Informações sobre total de médicos"
                [appTooltip]="'Quantidade total de médicos aprovados e ativos no sistema'"
                [tooltipPosition]="'top'"
              >
                <svg class="w-3.5 h-3.5 text-neutral-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
              </button>
            </div>
            <div class="flex flex-col items-center text-center space-y-1">
              <p class="text-4xl font-bold text-neutral-900">{{ adminStats()?.total_doctors || 0 }}</p>
              <p class="text-sm text-neutral-600">médicos aprovados</p>
            </div>
          </div>
        </div>

        <!-- KPI 4: Pendentes de Aprovação - AMARELO -->
        <div class="bg-yellow-100 rounded-2xl shadow-sm border border-yellow-200 p-5 hover:shadow-md hover:-translate-y-1 transition-all duration-200 relative overflow-hidden">
          <div class="absolute inset-0 opacity-10">
            <svg class="absolute top-3 right-3 w-16 h-16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          </div>
          <div class="relative z-10">
            <div class="flex items-center justify-center gap-2 mb-2">
              <p class="text-xs font-medium text-neutral-700">Pendentes de Aprovação</p>
              <button
                type="button"
                class="inline-flex items-center justify-center p-1 rounded hover:bg-yellow-200/50 transition-colors"
                aria-label="Informações sobre médicos pendentes"
                [appTooltip]="'Médicos que se cadastraram no sistema e estão aguardando aprovação administrativa para começar a usar a plataforma'"
                [tooltipPosition]="'top'"
              >
                <svg class="w-3.5 h-3.5 text-neutral-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
              </button>
            </div>
            <div class="flex flex-col items-center text-center space-y-1">
              <p class="text-4xl font-bold text-neutral-900">{{ adminStats()?.pending_doctors || 0 }}</p>
              <p class="text-sm text-neutral-600">aguardando aprovação</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SEÇÃO 2: MÉDICOS PENDENTES DE APROVAÇÃO -->
    <div class="space-y-5">
      <h2 class="text-xl font-bold text-neutral-900">Médicos Pendentes de Aprovação</h2>

      <div class="grid grid-cols-1 gap-6">
        <!-- Card de Médicos Pendentes -->
        <div class="bg-white rounded-2xl shadow-sm border border-neutral-200 p-6">
          <div class="flex items-center gap-2 mb-4">
            <h3 class="text-lg font-semibold text-neutral-900">Aguardando Aprovação</h3>
            <button
              type="button"
              class="inline-flex items-center justify-center p-1 rounded hover:bg-neutral-100 transition-colors"
              aria-label="Informações sobre médicos pendentes"
              [appTooltip]="'Lista de médicos cadastrados que precisam ser aprovados antes de acessar o sistema'"
              [tooltipPosition]="'top'"
            >
              <svg class="w-4 h-4 text-neutral-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
              </svg>
            </button>
          </div>

          @if (hasPendingDoctors()) {
            <div class="space-y-3 max-h-96 overflow-y-auto">
              @for (doctor of pendentDoctors(); track doctor.id) {
                <div class="border border-neutral-200 rounded-lg p-3 hover:bg-neutral-50 transition-colors cursor-pointer" (click)="viewDoctorDetails(doctor.id)">
                  <div class="flex items-start justify-between mb-2">
                    <div class="flex items-center gap-2">
                      <div class="w-10 h-10 rounded-full bg-yellow-100 flex items-center justify-center text-yellow-700 font-semibold text-sm">
                        {{ getDoctorInitials(doctor.name) }}
                      </div>
                      <div class="flex-1">
                        <p class="text-sm font-semibold text-neutral-900">{{ doctor.name }}</p>
                        <p class="text-xs text-neutral-500">{{ doctor.email }}</p>
                      </div>
                    </div>
                    <span class="text-xs px-2 py-1 rounded-full border bg-yellow-100 text-yellow-800 border-yellow-200">
                      Pendente
                    </span>
                  </div>
                  <div class="flex items-center justify-between text-xs">
                    <span class="text-neutral-600">CRM:</span>
                    <span class="font-medium text-neutral-900">{{ doctor.crm }}</span>
                  </div>
                </div>
              }
            </div>
          } @else {
            <div class="text-center py-12 text-neutral-500">
              <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <p class="text-sm">Nenhum médico pendente de aprovação</p>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
}
