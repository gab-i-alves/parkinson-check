<div class="bg-neutral-50">
  <div class="max-w-7xl mx-auto px-6 py-8">
    @if (isLoading()) {
    <!-- Enhanced Skeleton Loader -->
    <div class="space-y-6 animate-pulse">
      <!-- Actions Bar Skeleton -->
      <div class="flex items-center justify-between">
        <div class="inline-flex items-center gap-2 bg-neutral-100 rounded-full p-1">
          <div class="h-9 bg-neutral-200 rounded-full w-20"></div>
          <div class="h-9 bg-neutral-200 rounded-full w-24"></div>
          <div class="h-9 bg-neutral-200 rounded-full w-28"></div>
        </div>
      </div>

      <!-- Content skeleton -->
      <div class="bg-white rounded-2xl shadow-sm border border-neutral-200 p-6">
        <div class="space-y-4">
          <div class="h-6 bg-neutral-200 rounded w-1/4"></div>
          <div class="h-4 bg-neutral-200 rounded w-3/4"></div>
          <div class="h-4 bg-neutral-200 rounded w-1/2"></div>
          <div class="h-32 bg-neutral-200 rounded-xl mt-6"></div>
        </div>
      </div>
    </div>
    } @else if (errorMessage()) {
    <!-- Estado de Erro -->
    <div class="bg-white rounded-2xl shadow-sm border border-neutral-200 p-12 text-center">
      <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
        <svg class="w-10 h-10 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
          />
        </svg>
      </div>
      <h3 class="text-lg font-semibold text-neutral-900 mb-2">Erro ao Carregar Resultados</h3>
      <p class="text-sm text-neutral-600 mb-6">{{ errorMessage() }}</p>
      <button
        (click)="goBack()"
        class="px-6 py-2.5 bg-neutral-900 text-white rounded-full text-sm font-medium hover:bg-neutral-800 transition-colors"
      >
        Voltar ao Dashboard
      </button>
    </div>
    } @else {
    <div class="space-y-6">
      <!-- Actions Bar -->
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <!-- Tabs Pills Navigation -->
        <div class="inline-flex items-center gap-2 bg-neutral-100 rounded-full p-1">
          <button
            (click)="selectTab('charts')"
            [class]="
              activeTab() === 'charts'
                ? 'px-4 py-2 rounded-full bg-white shadow-sm text-sm font-medium text-neutral-900 transition-all'
                : 'px-4 py-2 rounded-full text-sm font-medium text-neutral-600 hover:text-neutral-900 transition-all'
            "
          >
            Gráficos
          </button>
          <button
            (click)="selectTab('history')"
            [class]="
              activeTab() === 'history'
                ? 'px-4 py-2 rounded-full bg-white shadow-sm text-sm font-medium text-neutral-900 transition-all'
                : 'px-4 py-2 rounded-full text-sm font-medium text-neutral-600 hover:text-neutral-900 transition-all'
            "
          >
            Histórico
          </button>
          <button
            (click)="selectTab('statistics')"
            [class]="
              activeTab() === 'statistics'
                ? 'px-4 py-2 rounded-full bg-white shadow-sm text-sm font-medium text-neutral-900 transition-all'
                : 'px-4 py-2 rounded-full text-sm font-medium text-neutral-600 hover:text-neutral-900 transition-all'
            "
          >
            Estatísticas
          </button>
        </div>

        <!-- Action Buttons -->
        <div class="flex items-center gap-3">
          <button
            (click)="goBack()"
            class="inline-flex items-center gap-2 px-4 py-2 bg-neutral-100 text-neutral-900 rounded-full hover:bg-neutral-200 transition-all text-sm font-medium"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
            Voltar
          </button>
        </div>
      </div>

      <!-- Tab Content Card -->
      <div class="bg-white rounded-2xl shadow-sm border border-neutral-200 overflow-hidden">
        <div class="p-6">
          @switch (activeTab()) {
          @case ('charts') {
            <app-charts-tab [timeline]="timeline()" [statistics]="statistics()" />
          }
          @case ('history') {
            <app-history-tab
              [timeline]="timeline()"
              [patientId]="patientId"
              [isPatientView]="true"
            />
          }
          @case ('statistics') {
            <app-statistics-tab [statistics]="statistics()" />
          }
          }
        </div>
      </div>
    </div>
    }
  </div>
</div>
