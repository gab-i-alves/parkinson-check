<div class="w-full max-w-xl mx-auto">
  <div class="rounded-lg bg-white p-6 shadow-sm md:p-8">
    <div class="text-center">
      <a
        routerLink="/"
        class="inline-flex items-center justify-center space-x-3"
      >
        <div
          class="flex h-12 w-12 items-center justify-center rounded-lg bg-violet-700"
        >
          <span class="text-2xl font-bold text-white">P</span>
        </div>
        <h1 class="text-3xl font-bold text-gray-800">ParkinsonCheck</h1>
      </a>
      <h2 class="mt-4 text-2xl font-semibold text-gray-900">Crie sua conta</h2>
      <p class="mt-2 text-base text-gray-600">
        Escolha seu perfil para iniciar o cadastro.
      </p>
    </div>

    <div class="mt-8 flex border-b border-gray-200">
      <button
        (click)="selectTab('paciente')"
        [ngClass]="{
          'border-violet-600 text-violet-600': activeTab === 'paciente',
          'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700':
            activeTab !== 'paciente'
        }"
        class="flex-1 whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium transition-colors duration-200 focus:outline-none"
      >
        Sou Paciente
      </button>
      <button
        (click)="selectTab('medico')"
        [ngClass]="{
          'border-violet-600 text-violet-600': activeTab === 'medico',
          'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700':
            activeTab !== 'medico'
        }"
        class="flex-1 whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium transition-colors duration-200 focus:outline-none"
      >
        Sou Médico
      </button>
    </div>

    <form
      *ngIf="activeTab === 'paciente'"
      [formGroup]="patientRegisterForm"
      (ngSubmit)="onPatientSubmit()"
      class="mt-8 space-y-8"
      novalidate
    >
      <div *ngIf="apiError" class="rounded-md bg-red-50 p-4">
        <p class="text-sm font-medium text-red-800">{{ apiError }}</p>
      </div>

      <section>
        <h3 class="text-lg font-semibold text-gray-800">Dados Pessoais</h3>
        <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2">
          <div class="sm:col-span-2">
            <label
              for="fullName"
              class="block text-sm font-medium text-gray-700"
              >Nome Completo*</label
            >
            <input
              id="fullName"
              name="fullName"
              formControlName="fullName"
              type="text"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="Digite seu nome completo"
            />
            <div
              *ngIf="
                patientRegisterForm.get('fullName')?.invalid &&
                patientRegisterForm.get('fullName')?.touched
              "
              class="mt-1 text-xs text-red-600"
            >
              <span
                *ngIf="patientRegisterForm.get('fullName')?.errors?.['required']"
                >Campo obrigatório.</span
              >
              <span
                *ngIf="patientRegisterForm.get('fullName')?.errors?.['minlength']"
                >O nome deve ter pelo menos 3 caracteres.</span
              >
            </div>
          </div>
          <div>
            <label for="cpf" class="block text-sm font-medium text-gray-700"
              >CPF*</label
            >
            <input
              id="cpf"
              name="cpf"
              type="text"
              formControlName="cpf"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="000.000.000-00"
            />
            <div
              *ngIf="
                patientRegisterForm.get('cpf')?.invalid &&
                patientRegisterForm.get('cpf')?.touched
              "
              class="mt-1 text-xs text-red-600"
            >
              <span *ngIf="patientRegisterForm.get('cpf')?.errors?.['required']"
                >Campo obrigatório.</span
              >
            </div>
          </div>
          <div>
            <label
              for="birthDate"
              class="block text-sm font-medium text-gray-700"
              >Data de Nascimento*</label
            >
            <input
              id="birthDate"
              name="birthDate"
              formControlName="birthDate"
              type="date"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
            />
            <div
              *ngIf="
                patientRegisterForm.get('birthDate')?.invalid &&
                patientRegisterForm.get('birthDate')?.touched
              "
              class="mt-1 text-xs text-red-600"
            >
              <span
                *ngIf="patientRegisterForm.get('birthDate')?.errors?.['required']"
                >Campo obrigatório.</span
              >
            </div>
          </div>
        </div>
      </section>

      <section>
        <h3 class="text-lg font-semibold text-gray-800">Segurança</h3>
        <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2">
          <div>
            <label for="email" class="block text-sm font-medium text-gray-700"
              >E-mail*</label
            >
            <input
              id="email"
              name="email"
              type="email"
              formControlName="email"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="Digite seu e-mail"
            />
            <div
              *ngIf="
                patientRegisterForm.get('email')?.invalid &&
                patientRegisterForm.get('email')?.touched
              "
              class="mt-1 text-xs text-red-600"
            >
              <span
                *ngIf="patientRegisterForm.get('email')?.errors?.['required']"
                >Campo obrigatório.</span
              >
              <span *ngIf="patientRegisterForm.get('email')?.errors?.['email']"
                >Por favor, insira um e-mail válido.</span
              >
            </div>
          </div>
          <div>
            <label
              for="password"
              class="block text-sm font-medium text-gray-700"
              >Senha*</label
            >
            <input
              id="password"
              name="password"
              type="password"
              formControlName="password"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="Digite sua senha"
            />
            <div
              *ngIf="
                patientRegisterForm.get('password')?.invalid &&
                patientRegisterForm.get('password')?.touched
              "
              class="mt-1 text-xs text-red-600"
            >
              <span
                *ngIf="patientRegisterForm.get('password')?.errors?.['required']"
                >Campo obrigatório.</span
              >
              <span
                *ngIf="patientRegisterForm.get('password')?.errors?.['minlength']"
                >A senha deve ter pelo menos 8 caracteres.</span
              >
            </div>
            <p class="mt-2 text-xs text-gray-500">
              Mínimo de 8 caracteres, com uma letra maiúscula e um número.
            </p>
          </div>
          <div>
            <label
              for="confirmPassword"
              class="block text-sm font-medium text-gray-700"
              >Confirme sua Senha*</label
            >
            <input
              type="password"
              id="confirmPassword"
              formControlName="confirmPassword"
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="Digite sua senha novamente"
            />
            <div
              *ngIf="
                patientRegisterForm.get('confirmPassword')?.invalid &&
                patientRegisterForm.get('confirmPassword')?.touched
              "
              class="mt-1 text-xs text-red-600"
            >
              <span
                *ngIf="patientRegisterForm.get('confirmPassword')?.errors?.['required']"
                >Campo obrigatório.</span
              >
              <span
                *ngIf="patientRegisterForm.get('confirmPassword')?.errors?.['mismatch']"
                >As senhas não coincidem.</span
              >
            </div>
          </div>
        </div>
      </section>

      <div
        class="flex items-center justify-end space-x-4 border-t border-gray-200 pt-6"
      >
        <a
          routerLink="/auth/login"
          class="rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2"
        >
          Já tenho conta
        </a>
        <button
          type="submit"
          [disabled]="patientRegisterForm.invalid || isLoading"
          class="rounded-md border border-transparent bg-violet-700 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-violet-800 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2"
        >
          <svg
            *ngIf="isLoading"
            class="animate-spin -ml-1 mr-3 h-5 w-5 text-white"
            ...
          ></svg>
          <span *ngIf="!isLoading">Criar Conta de Paciente</span>
        </button>
      </div>
    </form>

    <form
      *ngIf="activeTab === 'medico'"
      [formGroup]="doctorRegisterForm"
      (ngSubmit)="onDoctorSubmit()"
      class="mt-8 space-y-8"
      novalidate
    >
      <div *ngIf="apiError" class="rounded-md bg-red-50 p-4">
        <p class="text-sm font-medium text-red-800">{{ apiError }}</p>
      </div>

      <section>
        <h3 class="text-lg font-semibold text-gray-800">Dados Pessoais</h3>
        <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2">
          <div class="sm:col-span-2">
            <label
              for="fullName_medico"
              class="block text-sm font-medium text-gray-700"
              >Nome Completo*</label
            >
            <input
              id="fullName_medico"
              name="fullName_medico"
              formControlName="fullName"
              type="text"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="Digite seu nome completo"
            />
            <div
              *ngIf="
                doctorRegisterForm.get('fullName')?.invalid &&
                doctorRegisterForm.get('fullName')?.touched
              "
              class="mt-1 text-xs text-red-600"
            ></div>
          </div>
          <div>
            <label
              for="cpf_medico"
              class="block text-sm font-medium text-gray-700"
              >CPF*</label
            >
            <input
              id="cpf_medico"
              name="cpf_medico"
              formControlName="cpf"
              type="text"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="000.000.000-00"
            />
            <div
              *ngIf="
                doctorRegisterForm.get('cpf')?.invalid &&
                doctorRegisterForm.get('cpf')?.touched
              "
              class="mt-1 text-xs text-red-600"
            ></div>
          </div>
          <div>
            <label
              for="birthDate_medico"
              class="block text-sm font-medium text-gray-700"
              >Data de Nascimento*</label
            >
            <input
              id="birthDate_medico"
              name="birthDate_medico"
              formControlName="birthDate"
              type="date"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
            />
            <div
              *ngIf="
                doctorRegisterForm.get('birthDate')?.invalid &&
                doctorRegisterForm.get('birthDate')?.touched
              "
              class="mt-1 text-xs text-red-600"
            ></div>
          </div>
        </div>
      </section>

      <section>
        <h3 class="text-lg font-semibold text-gray-800">Dados Profissionais</h3>
        <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2">
          <div>
            <label for="crm" class="block text-sm font-medium text-gray-700"
              >CRM*</label
            >
            <input
              id="crm"
              name="crm"
              type="text"
              required
              formControlName="crm"
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="00000-UF"
            />
            <div
              *ngIf="
                doctorRegisterForm.get('crm')?.invalid &&
                doctorRegisterForm.get('crm')?.touched
              "
              class="mt-1 text-xs text-red-600"
            ></div>
          </div>
          <div>
            <label
              for="specialty"
              class="block text-sm font-medium text-gray-700"
              >Especialidade*</label
            >
            <select
              id="specialty"
              formControlName="specialty"
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
            >
              <option>Neurologia</option>
              <option>Geriatria</option>
              <option>Outra</option>
            </select>
            <div
              *ngIf="
                doctorRegisterForm.get('specialty')?.invalid &&
                doctorRegisterForm.get('specialty')?.touched
              "
              class="mt-1 text-xs text-red-600"
            ></div>
          </div>
        </div>
      </section>

      <section>
        <h3 class="text-lg font-semibold text-gray-800">Documentação</h3>
        <div class="mt-4 rounded-md border border-yellow-300 bg-yellow-50 p-4">
          <p class="text-sm text-yellow-800">
            <strong>Importante:</strong> Seu cadastro passará por verificação.
            Você receberá um e-mail quando sua conta for aprovada.
          </p>
        </div>
        <div class="mt-6">
          <label
            for="file-upload"
            class="block text-sm font-medium text-gray-700"
            >Carteira do CRM (frente e verso)*</label
          >
          <div
            class="mt-2 flex justify-center rounded-md border-2 border-dashed border-gray-300 px-6 pt-5 pb-6"
          >
            <div class="space-y-1 text-center">
              <svg
                class="mx-auto h-12 w-12 text-gray-400"
                stroke="currentColor"
                fill="none"
                viewBox="0 0 48 48"
                aria-hidden="true"
              >
                <path
                  d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <div class="flex text-sm text-gray-600">
                <label
                  for="file-upload"
                  class="relative cursor-pointer rounded-md bg-white font-medium text-violet-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-violet-500 focus-within:ring-offset-2 hover:text-violet-500"
                >
                  <span>Carregar um arquivo</span>
                  <input
                    id="file-upload"
                    name="file-upload"
                    type="file"
                    class="sr-only"
                  />
                </label>
                <p class="pl-1">ou arraste e solte</p>
              </div>
              <p class="text-xs text-gray-500">PNG, JPG, PDF até 5MB</p>
            </div>
          </div>
        </div>
      </section>

      <section>
        <h3 class="text-lg font-semibold text-gray-800">Segurança</h3>
        <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2">
          <div>
            <label
              for="email_medico"
              class="block text-sm font-medium text-gray-700"
              >E-mail*</label
            >
            <input
              id="email_medico"
              name="email_medico"
              type="email"
              required
              formControlName="email"
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="Digite seu e-mail"
            />
            <div
              *ngIf="
                doctorRegisterForm.get('email')?.invalid &&
                doctorRegisterForm.get('email')?.touched
              "
              class="mt-1 text-xs text-red-600"
            ></div>
          </div>
          <div>
            <label
              for="password_medico"
              class="block text-sm font-medium text-gray-700"
              >Senha*</label
            >
            <input
              id="password_medico"
              name="password_medico"
              formControlName="password"
              type="password"
              required
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="Digite sua senha"
            />
            <div
              *ngIf="
                doctorRegisterForm.get('password')?.invalid &&
                doctorRegisterForm.get('password')?.touched
              "
              class="mt-1 text-xs text-red-600"
            ></div>
            <p class="mt-2 text-xs text-gray-500">
              Mínimo de 8 caracteres, com uma letra maiúscula e um número.
            </p>
          </div>
          <div>
            <label
              for="confirmPassword"
              class="block text-sm font-medium text-gray-700"
              >Confirme sua Senha*</label
            >
            <input
              type="password"
              id="confirmPassword"
              formControlName="confirmPassword"
              class="block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-violet-500 focus:outline-none focus:ring-violet-500 sm:text-sm"
              placeholder="Digite sua senha novamente"
            />
            <div
              *ngIf="
                patientRegisterForm.get('confirmPassword')?.invalid &&
                patientRegisterForm.get('confirmPassword')?.touched
              "
              class="mt-1 text-xs text-red-600"
            >
              <span
                *ngIf="patientRegisterForm.get('confirmPassword')?.errors?.['required']"
                >Campo obrigatório.</span
              >
              <span
                *ngIf="patientRegisterForm.get('confirmPassword')?.errors?.['mismatch']"
                >As senhas não coincidem.</span
              >
            </div>
          </div>
        </div>
      </section>

      <div
        class="flex items-center justify-end space-x-4 border-t border-gray-200 pt-6"
      >
        <a
          routerLink="/auth/login"
          class="rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2"
        >
          Já tenho conta
        </a>
        <button
          type="submit"
          [disabled]="doctorRegisterForm.invalid || isLoading"
          class="rounded-md border border-transparent bg-violet-700 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-violet-800 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2"
        >
          <svg
            *ngIf="isLoading"
            class="animate-spin -ml-1 mr-3 h-5 w-5 text-white"
            ...
          ></svg>
          <span *ngIf="!isLoading">Criar Conta de Médico</span>
        </button>
      </div>
    </form>
  </div>
</div>
