@if (isVisible() && patient()) {
  <!-- Overlay - cobre toda a tela -->
<div
  class="fixed top-0 left-0 right-0 bottom-0 w-screen h-screen bg-black bg-opacity-50 transition-opacity"
  (click)="onClose()"
  style="position: fixed !important; inset: 0 !important; z-index: 99998 !important; width: 100vw !important; height: 100vh !important;"
></div>

<!-- Modal Container -->
<div
  class="fixed top-0 left-0 right-0 bottom-0 w-screen h-screen flex items-center justify-center p-4"
  style="position: fixed !important; inset: 0 !important; z-index: 99999 !important; pointer-events: none; width: 100vw !important; height: 100vh !important;"
>
  <div
    (click)="$event.stopPropagation()"
    class="relative w-full max-w-md transform rounded-2xl bg-white shadow-2xl transition-all"
    style="pointer-events: auto;"
  >
    <!-- Close Button -->
    <button
      (click)="onClose()"
      type="button"
      class="absolute top-4 right-4 z-10 flex items-center justify-center w-10 h-10 text-neutral-600 bg-white border border-neutral-300 rounded-lg hover:bg-neutral-50 hover:text-neutral-900 transition-all shadow-sm"
    >
      <svg
        class="h-5 w-5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"
        />
      </svg>
    </button>

    <!-- Header -->
    <div class="border-b border-neutral-200 bg-pink-50 p-6 rounded-t-2xl">
      <div class="flex flex-col items-center text-center">
        <div
          class="h-20 w-20 flex-shrink-0 bg-pink-700 rounded-full flex items-center justify-center shadow-lg mb-4"
        >
          <span class="text-3xl font-bold text-white">{{
            patient()!.name.charAt(0).toUpperCase()
          }}</span>
        </div>
        <h3 class="text-2xl font-bold text-neutral-900">
          {{ patient()!.name }}
        </h3>
        <p class="text-sm text-neutral-600 mt-1">{{ patient()!.email }}</p>
      </div>
    </div>

    <!-- Content -->
    <div class="p-6">
      <dl class="space-y-4">
        @if (patient()!.cpf) {
        <div class="flex justify-between items-center py-3 border-b border-neutral-100">
          <dt class="text-sm font-medium text-neutral-500">CPF</dt>
          <dd class="text-sm text-neutral-900 font-semibold">{{ patient()!.cpf | cpf }}</dd>
        </div>
        }

        <div class="flex justify-between items-center py-3 border-b border-neutral-100">
          <dt class="text-sm font-medium text-neutral-500">Email</dt>
          <dd class="text-sm text-neutral-900 font-semibold">{{ patient()!.email }}</dd>
        </div>

        @if (patient()!.age && patient()!.age! > 0) {
        <div class="flex justify-between items-center py-3 border-b border-neutral-100">
          <dt class="text-sm font-medium text-neutral-500">Idade</dt>
          <dd class="text-sm text-neutral-900 font-semibold">{{ patient()!.age }} anos</dd>
        </div>
        }

        @if (patient()!.status && patient()!.status !== 'pending') {
        <div class="flex justify-between items-center py-3 border-b border-neutral-100">
          <dt class="text-sm font-medium text-neutral-500">Status</dt>
          <dd>
            <span
              [class]="getStatusClass(patient()!.status)"
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold"
            >
              {{ getStatusText(patient()!.status) }}
            </span>
          </dd>
        </div>
        }
      </dl>
    </div>

    <!-- Footer -->
    <div class="border-t border-neutral-200 bg-neutral-50 p-6 rounded-b-2xl">
      <button
        (click)="onClose()"
        type="button"
        class="w-full inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-full text-white bg-neutral-900 hover:bg-neutral-800 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-200 transition-all"
      >
        Fechar
      </button>
    </div>
  </div>
</div>
}
